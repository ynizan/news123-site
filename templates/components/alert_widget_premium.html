<!-- Premium Email Alert Widget for Permit Pages -->
<div class="rounded-lg p-6 border-2" style="background: linear-gradient(135deg, rgba(0, 51, 102, 0.05) 0%, rgba(0, 119, 255, 0.05) 100%); border-color: var(--primary);">
    <div class="flex items-start justify-between mb-4">
        <div class="flex items-center">
            <svg class="w-8 h-8 mr-3" style="color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
            </svg>
            <div>
                <h3 class="text-xl font-bold" style="color: var(--primary);">Get Notified of Changes</h3>
            </div>
        </div>
        <span class="inline-flex items-center px-3 py-1 text-xs font-bold rounded-full" style="background: var(--accent); color: white;">
            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
            </svg>
            PRO FEATURE
        </span>
    </div>

    <p class="mb-4" style="color: var(--text-light);">Never miss updates to requirements, costs, or deadlines for this permit. Get instant email notifications when anything changes.</p>

    <form id="alertForm" class="space-y-3">
        <div>
            <input
                type="email"
                id="alertEmail"
                placeholder="you@example.com"
                class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-blue-500 focus:outline-none"
                required
            >
        </div>

        <button
            type="submit"
            id="alertSubmitBtn"
            class="w-full px-6 py-3 rounded-lg font-semibold transition"
            style="background: var(--accent); color: white;"
            onmouseover="this.style.opacity='0.9'"
            onmouseout="this.style.opacity='1'"
            onclick="handleAlertClick(event)"
        >
            Subscribe to Alerts • $39/mo
        </button>

        <p class="text-xs text-center" style="color: var(--text-light);">
            Includes up to 10 permit alerts + CSV exports + Historic data<br>
            <a href="/pricing/" style="color: var(--primary); text-decoration: underline;">See all Pro features →</a>
        </p>
    </form>
</div>

<script>
function handleAlertClick(event) {
    event.preventDefault();

    const email = document.getElementById('alertEmail').value;
    const permitName = '{{ request_type }}';

    // Track the click
    if (typeof plausible !== 'undefined') {
        plausible('Alert CTA Click', {
            props: {
                permit: '{{ permit_slug }}',
                has_email: email ? 'yes' : 'no',
                source: 'permit-page'
            }
        });
    }

    // Build redirect URL with parameters
    let redirectUrl = '/coming-soon/?feature=alerts&permit=' + encodeURIComponent(permitName);
    if (email) {
        redirectUrl += '&email=' + encodeURIComponent(email);
    }

    // Redirect to coming soon page
    window.location.href = redirectUrl;
}
</script>
